## Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
## SPDX-License-Identifier: Apache-2.0

# This is a reusable workflow for running the Enablement test for App Signals.
# It is meant to be called from another workflow.
# Read more about reusable workflows: https://docs.github.com/en/actions/using-workflows/reusing-workflows#overview
name: Test
on:
  push:
    branches:
      - fix-java-25-ec2

permissions:
  id-token: write
  contents: read

jobs:
  java-ec2-default:
    strategy:
      matrix:
        include:
          - java-version: '8'
            jar-suffix: 'v8'
          - java-version: '11'
            jar-suffix: 'v11'
          - java-version: '17'
            jar-suffix: 'v17'
          - java-version: '21'
            jar-suffix: 'v21'
          - java-version: '25'
            jar-suffix: 'v25'
      fail-fast: false
    uses: ./.github/workflows/java-ec2-default-test.yml
    secrets: inherit
    with:
      aws-region: us-east-1
      caller-workflow-name: 'test'
      java-version: ${{ matrix.java-version }}
      sample-app-jar: s3://ec2-java25-test/springboot-main-service-${{ matrix.jar-suffix }}.jar
      sample-remote-app-jar: s3://ec2-java25-test/springboot-remote-service-${{ matrix.jar-suffix }}.jar
